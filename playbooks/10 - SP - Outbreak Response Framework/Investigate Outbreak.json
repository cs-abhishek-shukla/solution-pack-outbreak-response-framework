{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Investigate Outbreak",
    "aliasName": null,
    "tag": null,
    "description": "Investigate Outbreak Alert on different SIEM tools, remediate and mitigate",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/2ae30943-7a2f-435b-a100-3ec7c3e2294b",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/69054683-770e-4caa-8727-b38d9c7da7e9",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": {
                "splunk_query": "[]",
                "q_radar_query": "[]",
                "elastic_search": "[]",
                "arc_sight_query": "[]",
                "fortisiem_query": "[]",
                "outbreak_alert_iri": "{{vars.input.records[0]['@id']}}",
                "fortiAnalyzer_query": "[]",
                "available_threat_hunt": "{{globalVars.threat_hunt_integrations}}",
                "azureLogAnalytics_query": "[]"
            },
            "status": null,
            "top": "300",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "acc4a508-9574-46d2-b13d-d902f7a2deab"
        },
        {
            "@type": "WorkflowStep",
            "name": "Configuration Params",
            "description": null,
            "arguments": {
                "faz_ADOM": "root",
                "fgt_vdom": "dev-r",
                "faz_device_id": "FGVM02TM23007442",
                "faz_device_name": "Enterprise_Second_Floor",
                "fgt_policy_name": "Outbreak",
                "fsm_event_count": "10",
                "fgt_address_group": "Block IP URL",
                "qradar_max_events": "10",
                "splunk_head_limit": "10",
                "faz_max_log_record": "10",
                "fsm_incident_count": "10",
                "fsm_max_log_record": "10",
                "last_pull_time_hrs": "-48",
                "fsm_incident_status": "Active",
                "splunk_search_query_index": "_audit",
                "splunk_search_query_sourcetype": "audittrail"
            },
            "status": null,
            "top": "165",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "8d2a98b5-24ab-4adb-a527-2fcea7287d09"
        },
        {
            "@type": "WorkflowStep",
            "name": "Create IOC Batch",
            "description": null,
            "arguments": {
                "url": "{{(vars.steps.Create_IOCs_as_Threat_Intel_Feeds | json_query(\"[?typeOfFeed.itemValue == 'URL'].value\")) | batch(20) | list}}",
                "user": "{{vars.steps.Create_IOCs_as_Threat_Intel_Feeds | json_query(\"[?typeOfFeed.itemValue == 'Actor'].value\") | batch(20) | list}}",
                "domain": "{{(vars.steps.Create_IOCs_as_Threat_Intel_Feeds | json_query(\"[?typeOfFeed.itemValue == 'Domain'].value\")) | batch(20) | list}}",
                "process": "{{vars.steps.Create_IOCs_as_Threat_Intel_Feeds | json_query(\"[?typeOfFeed.itemValue == 'Process'].value\") | batch(20) | list}}",
                "file_hash": "{{(vars.steps.Create_IOCs_as_Threat_Intel_Feeds | json_query(\"[?typeOfFeed.itemValue == 'FileHash'].value\")) | batch(20) | list}}",
                "ip_address": "{{(vars.steps.Create_IOCs_as_Threat_Intel_Feeds | json_query(\"[?typeOfFeed.itemValue == 'IP Address'].value\")) | batch(20) | list}}",
                "file_hash_md5": "{{(vars.steps.Create_IOCs_as_Threat_Intel_Feeds | json_query(\"[?typeOfFeed.itemValue == 'FileHash-MD5'].value\")) | batch(20) | list}}",
                "file_hash_sha1": "{{vars.steps.Create_IOCs_as_Threat_Intel_Feeds | json_query(\"[?typeOfFeed.itemValue == 'FileHash-SHA1'].value\") | batch(20) | list}}",
                "file_hash_sha256": "{{vars.steps.Create_IOCs_as_Threat_Intel_Feeds | json_query(\"[?typeOfFeed.itemValue == 'FileHash-SHA256'].value\") | batch(20) | list}}"
            },
            "status": null,
            "top": "1380",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "a1f2d8f1-917b-4e98-bf1c-57458829315a"
        },
        {
            "@type": "WorkflowStep",
            "name": "Create IOCs as Threat Intel Feeds",
            "description": null,
            "arguments": {
                "arguments": [],
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": true,
                "workflowReference": "\/api\/3\/workflows\/71c09b38-df72-4ed8-8e84-4c3a2ae1d261"
            },
            "status": null,
            "top": "570",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "group": null,
            "uuid": "6487a8b6-5a7f-4b67-a2cf-4360e2b31ef6"
        },
        {
            "@type": "WorkflowStep",
            "name": "Find KEVs CVEs",
            "description": null,
            "arguments": {
                "when": "{{vars.input.records[0].cVEList | length > 0}}",
                "arguments": [],
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": true,
                "workflowReference": "\/api\/3\/workflows\/e9cad34b-4393-4d31-a8f2-82a5a8cb0ade"
            },
            "status": null,
            "top": "435",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "group": null,
            "uuid": "861a11ec-6b1a-4999-9f13-2de5244f37b6"
        },
        {
            "@type": "WorkflowStep",
            "name": "Fortinet Fabrics Hunting",
            "description": null,
            "arguments": [],
            "status": null,
            "top": "1245",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "6ec0d132-7063-45aa-9400-069a376de0b5"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Hunting Rules",
            "description": null,
            "arguments": {
                "query": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                },
                "module": "threat_hunt_rules?$limit=30&$relationships=true&$fsr_max_relation_count=100",
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "",
                    "thread": false,
                    "content": "<p>Retrieving Threat Hunt Rules for <em><strong>Outbreak Alert: {{vars.input.records[0].title}}<\/strong><\/em><\/p>",
                    "records": "{{vars.input.records[0]['@id']}}",
                    "parentstepid": "\/api\/3\/workflow_steps\/69054683-770e-4caa-8727-b38d9c7da7e9"
                },
                "step_variables": []
            },
            "status": null,
            "top": "840",
            "left": "650",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928770",
            "group": null,
            "uuid": "6b11a28e-3ed5-4725-9228-728236b0ffbc"
        },
        {
            "@type": "WorkflowStep",
            "name": "IOC Hunting",
            "description": null,
            "arguments": [],
            "status": null,
            "top": "1245",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "a6fd6c2c-9149-424b-a524-f4f1fb1eac7d"
        },
        {
            "@type": "WorkflowStep",
            "name": "IOC Threat Hunt",
            "description": null,
            "arguments": {
                "arguments": {
                    "url": "{{vars.url}}",
                    "user": "{{vars.user}}",
                    "domain": "{{vars.domain}}",
                    "process": "{{vars.process}}",
                    "faz_ADOM": "{{vars.faz_ADOM}}",
                    "file_hash": "{{vars.file_hash}}",
                    "ip_address": "{{vars.ip_address}}",
                    "faz_device_id": "{{vars.faz_device_id}}",
                    "file_hash_md5": "{{vars.file_hash_md5}}",
                    "file_hash_sha1": "{{vars.file_hash_sha1}}",
                    "faz_device_name": "{{vars.faz_device_name}}",
                    "file_hash_sha256": "{{vars.file_hash_sha256}}",
                    "qradar_max_events": "{{vars.qradar_max_events}}",
                    "splunk_head_limit": "{{vars.splunk_head_limit}}",
                    "faz_max_log_record": "{{vars.faz_max_log_record}}",
                    "fsm_max_log_record": "{{vars.fsm_max_log_record}}",
                    "last_pull_time_hrs": "{{vars.last_pull_time_hrs}}",
                    "available_threat_hunt": "{{vars.available_threat_hunt}}",
                    "splunk_search_query_index": "{{vars.splunk_search_query_index}}",
                    "splunk_search_query_sourcetype": "{{vars.splunk_search_query_sourcetype}}"
                },
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": true,
                "workflowReference": "\/api\/3\/workflows\/020bc00b-b572-4855-a340-8027565a6b01"
            },
            "status": null,
            "top": "1515",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "group": null,
            "uuid": "94e70d58-8553-4bcf-a7a2-15cc594247a0"
        },
        {
            "@type": "WorkflowStep",
            "name": "Mitigation",
            "description": null,
            "arguments": {
                "type": "InputBased",
                "input": {
                    "schema": {
                        "title": "Mitigation Measures",
                        "description": "Following are the recommended mitigation measures are required for **{{vars.input.records[0].title}}**\n\n{{vars.input.records[0].mitigation}}",
                        "inputVariables": []
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "",
                    "thread": false,
                    "content": "<p>Following are the recommended mitigation measures are required for <strong>{{vars.input.records[0].title}}<\/strong><\/p>\n<p>&nbsp;<\/p>\n<p>{{vars.input.records[0].mitigation}}<\/p>",
                    "records": "{{vars.input.records[0]['@id']}}",
                    "parentstepid": "\/api\/3\/workflow_steps\/6b11a28e-3ed5-4725-9228-728236b0ffbc"
                },
                "agent_id": null,
                "resources": "outbreak_alerts",
                "owner_detail": {
                    "isAssigned": false
                },
                "isRecordLinked": true,
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "OK",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/356b5cd0-70cd-4e31-a950-62d4485d9f41"
                        }
                    ],
                    "duplicateOption": false
                },
                "email_notification": {
                    "enabled": false,
                    "smtpParameters": []
                },
                "inline_channel_list": [],
                "external_channel_list": [],
                "unauthenticated_input": false
            },
            "status": null,
            "top": "1785",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "group": null,
            "uuid": "146df7db-572d-4515-a2d1-615fcb90522f"
        },
        {
            "@type": "WorkflowStep",
            "name": "Remediation",
            "description": null,
            "arguments": {
                "arguments": {
                    "url": "{{vars.url | join(', ')}}",
                    "user": "{{vars.user | join(', ')}}",
                    "domain": "{{vars.domain | join(', ')}}",
                    "process": "{{vars.process | join(', ')}}",
                    "fgt_vdom": "{{vars.fgt_vdom}}",
                    "file_hash": "{{vars.file_hash | join(', ')}}",
                    "ip_address": "{{vars.ip_address | join(', ')}}",
                    "file_hash_md5": "{{vars.file_hash_md5 | join(', ')}}",
                    "file_hash_sha1": "{{vars.file_hash_sha1 | join(', ')}}",
                    "fgt_policy_name": "{{vars.fgt_policy_name}}",
                    "file_hash_sha256": "{{vars.file_hash_sha256 | join(', ')}}",
                    "fgt_address_group": "{{vars.fgt_address_group}}"
                },
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": true,
                "workflowReference": "\/api\/3\/workflows\/4d3d05aa-a2c7-460f-80bb-214726e0884f"
            },
            "status": null,
            "top": "1650",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "group": null,
            "uuid": "9c8029b7-fbb1-4f2f-ab2d-cfc3242be37e"
        },
        {
            "@type": "WorkflowStep",
            "name": "Set Hunting Rules",
            "description": null,
            "arguments": {
                "_tmp": "{% for item in vars.steps.Get_Hunting_Rules %}\n{% if item.fortiSIEM != None %}\n{% set _ = vars.fortisiem_query.append(item.fortiSIEM | from_json) %}\n{% endif %}\n{% if item.fortiAnalyzer != None %}\n{% set _ = vars.fortiAnalyzer_query.append(item.fortiAnalyzer | from_json) %}\n{% endif %}\n{% if item.qRadar != None %}\n{% set _ = vars.q_radar_query.append({\"title\": item.title, \"query\": item.qRadar}) %}\n{% endif %}\n{% if item.splunk != None %}\n{% set _ = vars.splunk_query.append({\"title\": item.title, \"query\": item.splunk}) %}\n{% endif %}\n{% if item.arcSight != None %}\n{% set _ = vars.arc_sight_query.append({\"title\": item.title, \"query\": item.arcSight}) %}\n{% endif %}\n{% if item.azureLogAnalytics != None %}\n{% set _ = vars.azureLogAnalytics_query.append({\"title\": item.title, \"query\": item.azureLogAnalytics}) %}\n{% endif %}\n{% endfor %}"
            },
            "status": null,
            "top": "975",
            "left": "650",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "7f280a37-35dc-4ff6-bb91-807f9751b842"
        },
        {
            "@type": "WorkflowStep",
            "name": "SIEM Hunting",
            "description": null,
            "arguments": [],
            "status": null,
            "top": "1110",
            "left": "825",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "a9033fcf-8625-40b0-b10c-b16bae882000"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "route": "b5814fbf-0355-4ed4-8b95-a9ed38bc1b25",
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "",
                    "thread": false,
                    "content": "<p>Initiating <strong><em>Outbreak Alert: {{vars.input.records[0].title}}<\/em><\/strong> Investigation<\/p>",
                    "records": "{{vars.input.records[0]['@id']}}"
                },
                "resources": [
                    "outbreak_alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                    "input": {
                        "params": [],
                        "records": "{{vars.input.records}}"
                    }
                },
                "displayConditions": {
                    "outbreak_alerts": {
                        "sort": [],
                        "limit": 30,
                        "logic": "AND",
                        "filters": []
                    }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": true
            },
            "status": null,
            "top": "30",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
            "group": null,
            "uuid": "69054683-770e-4caa-8727-b38d9c7da7e9"
        },
        {
            "@type": "WorkflowStep",
            "name": "Threat Hunt in Azure Log Analytics",
            "description": null,
            "arguments": {
                "when": "{{\"Azure Log Analytics\" in vars.available_threat_hunt and vars.azureLogAnalytics_query | length > 0}}",
                "for_each": {
                    "item": "{{vars.azureLogAnalytics_query}}",
                    "parallel": false,
                    "condition": ""
                },
                "arguments": {
                    "time_span": "{{vars.last_pull_time_hrs}}",
                    "azureLogAnalytics_query": "{{vars.item}}"
                },
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": true,
                "workflowReference": "\/api\/3\/workflows\/21d97105-d3fd-4ea2-9f34-c4c33e60aff4"
            },
            "status": null,
            "top": "1245",
            "left": "825",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "group": null,
            "uuid": "e3623dee-b2f7-4179-a4fb-2145d7af13d0"
        },
        {
            "@type": "WorkflowStep",
            "name": "Threat Hunt in FortiAnalyzer",
            "description": null,
            "arguments": {
                "when": "{{\"Fortinet FortiAnalyzer\" in vars.available_threat_hunt and vars.fortiAnalyzer_query | length > 0}}",
                "arguments": {
                    "from_date": "{{vars.last_pull_time_hrs}}",
                    "fortiAnalyzer_query": "{{vars.fortiAnalyzer_query}}"
                },
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": true,
                "workflowReference": "\/api\/3\/workflows\/87f3b5c5-f79e-492f-8540-f1f5ed5e1392"
            },
            "status": null,
            "top": "1380",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "group": null,
            "uuid": "b2fb4b0c-b6cd-43c6-8acd-940f6995d27d"
        },
        {
            "@type": "WorkflowStep",
            "name": "Threat Hunt in FortiSIEM",
            "description": null,
            "arguments": {
                "when": "{{\"Fortinet FortiSIEM\" in vars.available_threat_hunt and vars.fortisiem_query | length > 0}}",
                "for_each": {
                    "item": "{{vars.fortisiem_query}}",
                    "__bulk": false,
                    "parallel": false,
                    "condition": ""
                },
                "arguments": {
                    "to_date": "{{arrow.utcnow().format(\"YYYY-MM-DDTHH:mm:ss.SS\")}}Z",
                    "from_date": "{{arrow.utcnow().shift(hours=vars.last_pull_time_hrs).format('YYYY-MM-DDTHH:mm:ss.ssss')}}Z",
                    "fortiSIEM_query": "{{vars.item.eventType}}",
                    "fortisiem_event_count": "{{vars.fsm_event_count}}",
                    "fortisiem_incidentStatus": "{{vars.fsm_incident_status}}",
                    "fortisiem_incident_count": "{{vars.fsm_incident_count}}"
                },
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": true,
                "workflowReference": "\/api\/3\/workflows\/cc178f00-d898-4514-94e5-3388d5e3ac8e"
            },
            "status": null,
            "top": "1515",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "group": null,
            "uuid": "28d36fdd-05ac-46f9-949f-deceaf35ccef"
        },
        {
            "@type": "WorkflowStep",
            "name": "Threat Hunting",
            "description": null,
            "arguments": [],
            "status": null,
            "top": "705",
            "left": "650",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "b66314ab-6cb9-434b-a968-a63be99735a6"
        },
        {
            "@type": "WorkflowStep",
            "name": "Threat Hunt in QRadar",
            "description": null,
            "arguments": {
                "when": "{{\"IBM QRadar\" in vars.available_threat_hunt and vars.q_radar_query | length > 0}}",
                "for_each": {
                    "item": "{{vars.q_radar_query}}",
                    "parallel": false,
                    "condition": ""
                },
                "arguments": {
                    "max_event": "{{vars.qradar_max_events}}",
                    "q_radar_query": "{{vars.item}}",
                    "last_pull_time_hrs": "{{vars.last_pull_time_hrs}}"
                },
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": true,
                "workflowReference": "\/api\/3\/workflows\/bd0c5112-9cfd-428c-b39e-919c859d3032"
            },
            "status": null,
            "top": "1380",
            "left": "825",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "group": null,
            "uuid": "c39ef6a4-103f-4229-ab70-f79b83a93e73"
        },
        {
            "@type": "WorkflowStep",
            "name": "Threat Hunt in Splunk",
            "description": null,
            "arguments": {
                "when": "{{\"Splunk\" in vars.available_threat_hunt and vars.splunk_query | length > 0}}",
                "for_each": {
                    "item": "{{vars.splunk_query}}",
                    "parallel": false,
                    "condition": ""
                },
                "arguments": {
                    "head_limit": "{{vars.splunk_head_limit}}",
                    "splunk_query": "{{vars.item}}",
                    "earliest_time": "{{vars.last_pull_time_hrs}}h"
                },
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": true,
                "workflowReference": "\/api\/3\/workflows\/0285b815-4454-49af-ac72-a737d16fa11c"
            },
            "status": null,
            "top": "1515",
            "left": "825",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "group": null,
            "uuid": "2798ccb0-94da-47c9-ba43-54a42bca7a78"
        },
        {
            "@type": "WorkflowStep",
            "name": "Update Remediation Task",
            "description": null,
            "arguments": {
                "resource": {
                    "description": "{{vars.steps.Remediation.description}}\nFollowing are the recommended mitigation measures are required for **{{vars.input.records[0].title}}**\n\n{{vars.input.records[0].mitigation}}"
                },
                "operation": "Append",
                "collection": "{{vars.steps.Remediation['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/tasks",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1920",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "356b5cd0-70cd-4e31-a950-62d4485d9f41"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Azure Log Analytics Hunting -> QRadar Hunting",
            "targetStep": "\/api\/3\/workflow_steps\/c39ef6a4-103f-4229-ab70-f79b83a93e73",
            "sourceStep": "\/api\/3\/workflow_steps\/e3623dee-b2f7-4179-a4fb-2145d7af13d0",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "95090bd5-6a46-45c9-a0e1-fd8c27d3e5d1"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Find KEVs CVEs",
            "targetStep": "\/api\/3\/workflow_steps\/861a11ec-6b1a-4999-9f13-2de5244f37b6",
            "sourceStep": "\/api\/3\/workflow_steps\/acc4a508-9574-46d2-b13d-d902f7a2deab",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "84b6e564-75ad-4e03-9db2-a9639ce8c71b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration Params -> Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/acc4a508-9574-46d2-b13d-d902f7a2deab",
            "sourceStep": "\/api\/3\/workflow_steps\/8d2a98b5-24ab-4adb-a527-2fcea7287d09",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "7ddcd6d0-9929-48d7-a15d-5639c76bb81d"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create IOC Batch -> IOC Threat Hunt",
            "targetStep": "\/api\/3\/workflow_steps\/94e70d58-8553-4bcf-a7a2-15cc594247a0",
            "sourceStep": "\/api\/3\/workflow_steps\/a1f2d8f1-917b-4e98-bf1c-57458829315a",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "b1525754-34cb-4273-933a-856489bc3f8e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create IOCs as Threat Intel Feeds -> IOC Hunting",
            "targetStep": "\/api\/3\/workflow_steps\/a6fd6c2c-9149-424b-a524-f4f1fb1eac7d",
            "sourceStep": "\/api\/3\/workflow_steps\/6487a8b6-5a7f-4b67-a2cf-4360e2b31ef6",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "401a4be5-5604-43cb-a290-0bc71051b1e4"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create IOCs as Threat Intel Feeds -> Threat Hunting",
            "targetStep": "\/api\/3\/workflow_steps\/b66314ab-6cb9-434b-a968-a63be99735a6",
            "sourceStep": "\/api\/3\/workflow_steps\/6487a8b6-5a7f-4b67-a2cf-4360e2b31ef6",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "d0dadd78-4865-40d8-8b94-aa0718dc849b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Find KEVs CVEs -> Create IOCs as Threat Intel Feeds",
            "targetStep": "\/api\/3\/workflow_steps\/6487a8b6-5a7f-4b67-a2cf-4360e2b31ef6",
            "sourceStep": "\/api\/3\/workflow_steps\/861a11ec-6b1a-4999-9f13-2de5244f37b6",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "287ee133-9f3b-45ed-a7c2-159f9aae25e2"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Fortinet Fabrics Hunting -> Get FortiAnalyzer Events",
            "targetStep": "\/api\/3\/workflow_steps\/b2fb4b0c-b6cd-43c6-8acd-940f6995d27d",
            "sourceStep": "\/api\/3\/workflow_steps\/6ec0d132-7063-45aa-9400-069a376de0b5",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "9b8d706e-49f3-4c8c-9e7a-9f6f4e1a827b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get FortiAnalyzer Events -> Get FortiSIEM Incident",
            "targetStep": "\/api\/3\/workflow_steps\/28d36fdd-05ac-46f9-949f-deceaf35ccef",
            "sourceStep": "\/api\/3\/workflow_steps\/b2fb4b0c-b6cd-43c6-8acd-940f6995d27d",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "ec7227af-1687-497f-a36b-a742e6c84a4e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Hunting Rules -> Fortinet Fabric Hunting",
            "targetStep": "\/api\/3\/workflow_steps\/7f280a37-35dc-4ff6-bb91-807f9751b842",
            "sourceStep": "\/api\/3\/workflow_steps\/6b11a28e-3ed5-4725-9228-728236b0ffbc",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "24a34d46-3c8c-4dc6-95f5-292adedd9803"
        },
        {
            "@type": "WorkflowRoute",
            "name": "IOC Hunting -> Create IOC Batch",
            "targetStep": "\/api\/3\/workflow_steps\/a1f2d8f1-917b-4e98-bf1c-57458829315a",
            "sourceStep": "\/api\/3\/workflow_steps\/a6fd6c2c-9149-424b-a524-f4f1fb1eac7d",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "951852f5-8811-4cfc-93fb-85b3f279c37a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "IOC Threat Hunt -> Remediation",
            "targetStep": "\/api\/3\/workflow_steps\/9c8029b7-fbb1-4f2f-ab2d-cfc3242be37e",
            "sourceStep": "\/api\/3\/workflow_steps\/94e70d58-8553-4bcf-a7a2-15cc594247a0",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "0417ad51-7757-4400-9715-342f96ee6af4"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Mitigation -> Update Remediation Task",
            "targetStep": "\/api\/3\/workflow_steps\/356b5cd0-70cd-4e31-a950-62d4485d9f41",
            "sourceStep": "\/api\/3\/workflow_steps\/146df7db-572d-4515-a2d1-615fcb90522f",
            "label": "OK",
            "isExecuted": false,
            "group": null,
            "uuid": "95c504df-6089-4492-8a74-4e08b84478c6"
        },
        {
            "@type": "WorkflowRoute",
            "name": "QRadar Hunting -> Splunk Hunting",
            "targetStep": "\/api\/3\/workflow_steps\/2798ccb0-94da-47c9-ba43-54a42bca7a78",
            "sourceStep": "\/api\/3\/workflow_steps\/c39ef6a4-103f-4229-ab70-f79b83a93e73",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "70a10d98-5c01-4dcc-8895-2fb04c26ee5a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Remediation -> Mitigation",
            "targetStep": "\/api\/3\/workflow_steps\/146df7db-572d-4515-a2d1-615fcb90522f",
            "sourceStep": "\/api\/3\/workflow_steps\/9c8029b7-fbb1-4f2f-ab2d-cfc3242be37e",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "e9d25633-0db6-4136-b3d1-29bfbca0e0d7"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set Hunting Rules -> Fortinet Fabrics Hunting",
            "targetStep": "\/api\/3\/workflow_steps\/6ec0d132-7063-45aa-9400-069a376de0b5",
            "sourceStep": "\/api\/3\/workflow_steps\/7f280a37-35dc-4ff6-bb91-807f9751b842",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "3185dc81-ecbc-4eee-a2f8-e9ad2d936227"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set Hunting Rules -> SIEM Hunting",
            "targetStep": "\/api\/3\/workflow_steps\/a9033fcf-8625-40b0-b10c-b16bae882000",
            "sourceStep": "\/api\/3\/workflow_steps\/7f280a37-35dc-4ff6-bb91-807f9751b842",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "32234218-b9dc-485f-bd24-b970d120f176"
        },
        {
            "@type": "WorkflowRoute",
            "name": "SIEM Hunting -> Azure Log Analytics Hunting",
            "targetStep": "\/api\/3\/workflow_steps\/e3623dee-b2f7-4179-a4fb-2145d7af13d0",
            "sourceStep": "\/api\/3\/workflow_steps\/a9033fcf-8625-40b0-b10c-b16bae882000",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "1e164608-6413-4afc-8e2f-2fe79c460539"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configuration Params",
            "targetStep": "\/api\/3\/workflow_steps\/8d2a98b5-24ab-4adb-a527-2fcea7287d09",
            "sourceStep": "\/api\/3\/workflow_steps\/69054683-770e-4caa-8727-b38d9c7da7e9",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "7e89e302-7bd0-4e42-bed2-b7fdfa725b7f"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Threat Hunt in FortiSIEM -> Remediation",
            "targetStep": "\/api\/3\/workflow_steps\/9c8029b7-fbb1-4f2f-ab2d-cfc3242be37e",
            "sourceStep": "\/api\/3\/workflow_steps\/28d36fdd-05ac-46f9-949f-deceaf35ccef",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "cb73eaaa-9bc3-4179-9720-92f2478668b2"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Threat Hunting -> Get Hunting Rules",
            "targetStep": "\/api\/3\/workflow_steps\/6b11a28e-3ed5-4725-9228-728236b0ffbc",
            "sourceStep": "\/api\/3\/workflow_steps\/b66314ab-6cb9-434b-a968-a63be99735a6",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "2f5e0f5a-df0d-4b9e-a475-a75b0897e4cc"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Threat Hunt in Splunk -> Remediation",
            "targetStep": "\/api\/3\/workflow_steps\/9c8029b7-fbb1-4f2f-ab2d-cfc3242be37e",
            "sourceStep": "\/api\/3\/workflow_steps\/2798ccb0-94da-47c9-ba43-54a42bca7a78",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "ab7d30ad-bbd7-4a83-904f-7127ae36c677"
        }
    ],
    "groups": [],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "93d93b2d-1598-4bb7-9fa6-85c2f8b9d876",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "Outbreak Alert",
        "ManualTrigger"
    ]
}